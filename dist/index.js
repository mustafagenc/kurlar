'use strict';var fastXmlParser=require('fast-xml-parser'),T=require('axios');function _interopDefault(e){return e&&e.__esModule?e:{default:e}}var T__default=/*#__PURE__*/_interopDefault(T);var u=(e,o,n)=>new Promise((r,a)=>{var i=t=>{try{s(n.next(t));}catch(l){a(l);}},c=t=>{try{s(n.throw(t));}catch(l){a(l);}},s=t=>t.done?r(t.value):Promise.resolve(t.value).then(i,c);s((n=n.apply(e,o)).next());});function y({date:e}){let o=new Date(2016,8,8);return new Date(e.getFullYear(),e.getMonth(),e.getDate())>=o?"UTF-8":"ISO-8859-9"}function p(e){return e<10?`0${e}`:`${e}`}function g({date:e}){let o="https://www.tcmb.gov.tr/kurlar/today.xml",n="UTF-8";if(e){let r=new Date;if(r.setHours(0,0,0,0),new Date(e.getFullYear(),e.getMonth(),e.getDate())<=r){let i=e.getFullYear(),c=p(e.getMonth()),s=p(e.getDate());o=`https://www.tcmb.gov.tr/kurlar/${i}${c}/${s}${c}${i}.xml`,n=y({date:e});}}return {url:o,encoding:n}}function D(e){return u(this,null,function*(){let o=g({date:e}),n=[];try{let r=yield T__default.default.get(o.url,{headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8","Accept-Language":"en-US,en;q=0.8,tr;q=0.6","Accept-Charset":o.encoding}});if(fastXmlParser.XMLValidator.validate(r.data)!==!0)throw new Error("Invalid XML response");let i={ignoreAttributes:!1,allowBooleanAttributes:!0,ignoreDeclaration:!0,attributeNamePrefix:"@_",trimValues:!0},s=new fastXmlParser.XMLParser(i).parse(r.data);for(let t of s.Tarih_Date.Currency)n.push({Unit:t.Unit,CurrencyName:t.CurrencyName,CurrencyCode:t["@_CurrencyCode"],ForexBuying:t.ForexBuying,ForexSelling:t.ForexSelling,BanknoteBuying:t.BanknoteBuying,BanknoteSelling:t.BanknoteSelling});return n.length>0?n:null}catch(r){return Promise.reject(r)}})}function B(n){return u(this,arguments,function*({currency:e,date:o}){let r=yield D(o);return r&&r.find(i=>i.CurrencyCode===e)||null})}
exports.fetchAllCurrencies=D;exports.fetchCurrency=B;//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map